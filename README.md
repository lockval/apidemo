# lockval/apidemo

This is the source code of https://apidemo.lockval.com

You can download and edit client.yaml and public/server/...

to generate your own server

<!-- 
## Quick start

```sh
npm run buildBothAndPreview
```
-->

## 1. Use [Dev Container](https://code.visualstudio.com/docs/devcontainers/containers) to open project in vscode

You may need these tools:

- Visual Studio Code
- Docker Desktop

Follow the steps to open the project:
  1. Open this project in vscode
  2. Click ![Open a Remote Window](./imgs/orw.jpg) in the lower left corner
  3. Click "Reopen in Container"

If successful you will see ![Dev Container: apidemo](./imgs/devc.jpg) in the lower left corner

[Build a Linux development environment (not recommended)](https://github.com/lockval/apidemo/blob/main/doc/devenv.md)



## 2. Client Project Setup
in vscode TERMINAL:
```sh
cd /workspaces/apidemo/
npm install
```



## 3. start your services
in vscode TERMINAL:
```sh
./serverStart.sh
```



## 4. Build Server And Upload (Choose a language you want to use)

- JS
  #### edit public/server/javascript/... and run:
    ```sh
    npm run serverJsBuildAndUpload
    ```

- Lua
  #### edit public/server/lua/... and run:
    ```sh
    npm run serverLuaBuildAndUpload
    ```

- Starlark ([Starlark is a dialect of Python](https://github.com/bazelbuild/starlark))
  #### edit public/server/starlark/... and run:
    ```sh
    npm run serverStarBuildAndUpload
    ```

- Go
  #### edit public/server/go/... and run:
    ```sh
    npm run serverGoBuildAndUpload
    ```


## 4. Build Client And Preview
in vscode TERMINAL:
```sh
npm run clientBuildAndPreview
```
Click "Open in Browser" to open website

## Client Code:
- public/client/paclient.ts (core code)
- public/client/player.ts (User Event and Module Data Definition Code, Generated by client.yaml)


## Customize your own Authentication server

You can learn how to develop a login(Service AuthN) and a guest(3rd Platform AuthN) [here](https://github.com/lockval/authn)

## Define variables for your Production environment: 
(If you just want to preview locally, you can ignore this configuration)

```sh
export lockvalUpdatefileDomain=127.0.0.1:8080
export lockvalUpdatefilePassword=123456
export lockvalGwAddrs=http://127.0.0.1:59501,http://127.0.0.1:59502
```